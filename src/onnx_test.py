import time

import albumentations as A
import cv2
import numpy as np
import torch
import glob
from models.base_model import CRNN
from config import base_config as config
from utils.converter import StrLabelConverter
from dataset.utils import preprocess
import torch.nn as nn
import onnxruntime as onnxrt

DEVICE_NAME = 'cpu'
onnx_session= onnxrt.InferenceSession("/home/user/recognizer_pipeline/weights/recognizer_base.onnx", providers=['CPUExecutionProvider'])
converter = StrLabelConverter(config.alphabet)
transformer = A.Compose([A.NoOp()])

images = sorted(glob.glob('/home/user/recognizer_pipeline/debug/plates/test_image.jpg'))
for idx, image in enumerate(images):
    start_time = time.time()
    img = cv2.imread(image)
    preprocessed_image = preprocess(img, transform=transformer).unsqueeze(0).contiguous()
    binding = onnx_session.io_binding()
    binding.bind_input(
        name='actual_input',
        device_type=DEVICE_NAME,
        device_id=0,
        element_type=np.float32,
        shape=tuple(preprocessed_image.shape),
        buffer_ptr=preprocessed_image.data_ptr(),
    )
    z_tensor = torch.empty((1, 30, 37), dtype=torch.float32, device='cpu:0').contiguous()
    binding.bind_output(
        name='output',
        device_type=DEVICE_NAME,
        device_id=0,
        element_type=np.float32,
        shape=tuple(z_tensor.shape),
        buffer_ptr=z_tensor.data_ptr(),
    )
    onnx_session.run_with_iobinding(binding)
    predictions = z_tensor
    predictions = predictions.permute(1, 0, 2).contiguous()
    for idx,item in enumerate(predictions):
        for value in item[0]:
            print(str(value.item())[:5], end=",")
        print()
    prediction_size = torch.IntTensor([predictions.size(0)]).repeat(1)
    predicted_probs, predicted_labels = predictions.detach().cpu().max(2)
    predicted_test_labels = np.array(converter.decode(predicted_labels, prediction_size, raw=False))
    predicted_raw_test_labels = np.array(converter.decode(predicted_labels, prediction_size, raw=True))



    end_time = time.time() - start_time
    print(f'exec time:{end_time} label:{predicted_test_labels}')
    print(predicted_raw_test_labels)

#
# 0 tensor([[-1.1921e-07, -1.7846e+01, -1.8252e+01, -1.9269e+01, -2.0621e+01,
#          -1.9100e+01, -1.9125e+01, -1.9785e+01, -1.9694e+01, -1.9750e+01,
#          -1.9807e+01, -1.6497e+01, -1.8754e+01, -1.8736e+01, -2.0986e+01,
#          -1.8854e+01, -2.0444e+01, -2.1660e+01, -2.0657e+01, -1.9101e+01,
#          -2.1379e+01, -2.0136e+01, -1.9054e+01, -1.9858e+01, -2.0391e+01,
#          -1.9831e+01, -2.0277e+01, -2.2369e+01, -2.1429e+01, -1.9070e+01,
#          -2.0440e+01, -2.1927e+01, -2.1516e+01, -2.1244e+01, -2.0560e+01,
#          -2.1156e+01, -2.0412e+01]])
# 1 tensor([[  0.0000, -19.7302, -19.3606, -20.4614, -21.5882, -20.8960, -21.7885,
#          -22.4022, -21.0264, -22.0801, -22.2595, -18.8849, -21.4624, -20.8810,
#          -23.6383, -21.9408, -23.9205, -24.8091, -22.7565, -20.9520, -22.6036,
#          -23.6610, -21.5710, -22.9271, -23.7111, -22.4933, -23.3884, -25.0199,
#          -24.5373, -22.4303, -22.6150, -24.1251, -25.1351, -25.0963, -23.6470,
#          -24.0590, -22.4113]])
# 2 tensor([[  0.0000, -18.9324, -18.5793, -18.7953, -20.4702, -19.2006, -21.5428,
#          -21.6129, -19.6137, -21.7430, -22.1923, -19.5433, -22.2763, -21.9390,
#          -24.2565, -23.1180, -24.9307, -25.4581, -23.0404, -20.6492, -22.1438,
#          -24.2672, -21.9551, -23.5796, -23.9232, -22.7771, -23.8702, -25.3138,
#          -25.5694, -23.2131, -23.8638, -23.9120, -25.2863, -25.3577, -24.4599,
#          -25.0555, -22.6417]])
# 3 tensor([[  0.0000, -18.7313, -19.2832, -20.1903, -21.8723, -19.7083, -22.3529,
#          -22.1515, -20.8331, -22.4732, -22.6392, -21.2265, -24.4208, -23.4968,
#          -25.6661, -25.4235, -27.0772, -26.3564, -25.5818, -22.5313, -23.6176,
#          -26.6680, -23.7042, -25.5474, -25.6810, -23.7523, -26.7857, -26.3205,
#          -27.8253, -25.0278, -25.5795, -24.3118, -26.4314, -26.9054, -26.4132,
#          -27.1177, -24.8721]])
# 4 tensor([[-3.4451e-05, -1.0276e+01, -1.8203e+01, -2.0824e+01, -2.0319e+01,
#          -2.0097e+01, -1.9681e+01, -2.0428e+01, -1.9634e+01, -2.0214e+01,
#          -2.0061e+01, -2.0294e+01, -2.2279e+01, -2.1890e+01, -2.2198e+01,
#          -2.5165e+01, -2.5897e+01, -2.3208e+01, -2.5948e+01, -2.2089e+01,
#          -2.3605e+01, -2.6815e+01, -2.4293e+01, -2.5785e+01, -2.4990e+01,
#          -2.0030e+01, -2.5469e+01, -2.2805e+01, -2.6123e+01, -2.4525e+01,
#          -2.4216e+01, -2.1451e+01, -2.4725e+01, -2.5927e+01, -2.5419e+01,
#          -2.6028e+01, -2.5384e+01]])
# 5 tensor([[-1.2210e+01, -6.0797e-06, -1.5107e+01, -1.5183e+01, -1.6112e+01,
#          -1.7450e+01, -1.6570e+01, -1.6424e+01, -1.6163e+01, -1.6380e+01,
#          -1.6621e+01, -1.8792e+01, -2.1219e+01, -2.0779e+01, -1.9501e+01,
#          -2.3686e+01, -2.2949e+01, -2.1920e+01, -2.4213e+01, -2.1198e+01,
#          -2.2363e+01, -2.5691e+01, -2.3366e+01, -2.5359e+01, -2.2236e+01,
#          -1.6663e+01, -2.3088e+01, -2.0513e+01, -2.3454e+01, -2.4753e+01,
#          -2.1848e+01, -1.9060e+01, -2.3215e+01, -2.3269e+01, -2.2895e+01,
#          -2.3925e+01, -2.3121e+01]])
# 6 tensor([[-4.5299e-06, -1.2334e+01, -1.6229e+01, -1.7248e+01, -1.7856e+01,
#          -1.7999e+01, -1.8350e+01, -1.8271e+01, -1.7659e+01, -1.6850e+01,
#          -1.8077e+01, -1.9949e+01, -2.1387e+01, -2.1075e+01, -2.2372e+01,
#          -2.3083e+01, -2.4197e+01, -2.4559e+01, -2.3695e+01, -2.0584e+01,
#          -2.3087e+01, -2.3842e+01, -2.3110e+01, -2.4021e+01, -2.3500e+01,
#          -2.1505e+01, -2.3656e+01, -2.4709e+01, -2.4811e+01, -2.3972e+01,
#          -2.2792e+01, -2.1831e+01, -2.4093e+01, -2.3794e+01, -2.3738e+01,
#          -2.3457e+01, -2.3560e+01]])
# 7 tensor([[-7.0808e-05, -1.7509e+01, -9.5566e+00, -1.8394e+01, -1.8479e+01,
#          -1.9029e+01, -1.9435e+01, -1.8829e+01, -1.7607e+01, -1.8584e+01,
#          -1.8280e+01, -2.0275e+01, -2.2058e+01, -2.2061e+01, -2.4315e+01,
#          -2.4405e+01, -2.5371e+01, -2.3729e+01, -2.3634e+01, -1.9574e+01,
#          -2.1975e+01, -2.5521e+01, -2.3300e+01, -2.1620e+01, -2.5358e+01,
#          -2.2191e+01, -2.5187e+01, -2.5734e+01, -2.7410e+01, -2.3496e+01,
#          -2.1931e+01, -2.3081e+01, -2.5741e+01, -2.6740e+01, -2.3823e+01,
#          -2.3780e+01, -2.3809e+01]])
# 8 tensor([[-1.2474e+01, -1.4130e+01, -6.9141e-06, -1.5067e+01, -1.5133e+01,
#          -1.5292e+01, -1.6448e+01, -1.6153e+01, -1.3876e+01, -1.6715e+01,
#          -1.5364e+01, -1.8605e+01, -2.2527e+01, -2.1253e+01, -2.2410e+01,
#          -2.3534e+01, -2.2529e+01, -2.1521e+01, -2.0518e+01, -1.6728e+01,
#          -2.0603e+01, -2.3326e+01, -2.1077e+01, -1.8046e+01, -2.2386e+01,
#          -1.9931e+01, -2.2741e+01, -2.2478e+01, -2.3991e+01, -2.2742e+01,
#          -1.8461e+01, -2.2385e+01, -2.4207e+01, -2.4570e+01, -2.2332e+01,
#          -2.0843e+01, -2.1050e+01]])
# 9 tensor([[-1.1122e-04, -1.6441e+01, -9.1052e+00, -1.8056e+01, -1.8606e+01,
#          -1.7745e+01, -1.8493e+01, -1.8937e+01, -1.7770e+01, -1.8701e+01,
#          -1.7845e+01, -1.9310e+01, -2.1109e+01, -2.0817e+01, -2.3044e+01,
#          -2.2644e+01, -2.4064e+01, -2.3472e+01, -2.1722e+01, -1.8256e+01,
#          -2.2208e+01, -2.2924e+01, -2.1849e+01, -2.0189e+01, -2.2613e+01,
#          -2.0398e+01, -2.3196e+01, -2.4471e+01, -2.4933e+01, -2.2022e+01,
#          -2.0820e+01, -2.3264e+01, -2.5276e+01, -2.5112e+01, -2.2743e+01,
#          -2.3175e+01, -2.4087e+01]])
# 10 tensor([[-1.6451e-05, -1.1022e+01, -1.6239e+01, -2.0335e+01, -2.0057e+01,
#          -2.0112e+01, -1.9354e+01, -2.0012e+01, -1.9187e+01, -1.9307e+01,
#          -1.8678e+01, -2.0036e+01, -2.0982e+01, -2.0802e+01, -2.0810e+01,
#          -2.4447e+01, -2.5684e+01, -2.2869e+01, -2.4183e+01, -2.0966e+01,
#          -2.3725e+01, -2.5133e+01, -2.3721e+01, -2.4046e+01, -2.3485e+01,
#          -1.8244e+01, -2.3736e+01, -2.1881e+01, -2.4542e+01, -2.3844e+01,
#          -2.2582e+01, -2.1224e+01, -2.4924e+01, -2.5594e+01, -2.3928e+01,
#          -2.5365e+01, -2.5254e+01]])
# 11 tensor([[-1.1114e+01, -2.1219e-05, -1.3460e+01, -1.4516e+01, -1.4832e+01,
#          -1.5938e+01, -1.4994e+01, -1.4704e+01, -1.4435e+01, -1.4460e+01,
#          -1.4599e+01, -1.7313e+01, -1.8952e+01, -1.7967e+01, -1.6493e+01,
#          -2.1212e+01, -2.0585e+01, -1.9291e+01, -2.1170e+01, -1.9023e+01,
#          -2.0312e+01, -2.1688e+01, -2.0627e+01, -2.2142e+01, -1.9369e+01,
#          -1.3528e+01, -1.9671e+01, -1.7363e+01, -2.0014e+01, -2.2368e+01,
#          -1.8847e+01, -1.6311e+01, -2.0312e+01, -2.0592e+01, -1.9934e+01,
#          -2.1549e+01, -2.1404e+01]])
# 12 tensor([[-6.9377e-05, -9.5950e+00, -1.5113e+01, -1.7186e+01, -1.7452e+01,
#          -1.7554e+01, -1.6798e+01, -1.6996e+01, -1.5841e+01, -1.6419e+01,
#          -1.6445e+01, -1.5821e+01, -1.6718e+01, -1.6340e+01, -1.7014e+01,
#          -1.8418e+01, -1.9271e+01, -2.0228e+01, -1.9796e+01, -1.5961e+01,
#          -1.9582e+01, -1.9111e+01, -1.9115e+01, -2.0144e+01, -1.9301e+01,
#          -1.6213e+01, -1.7884e+01, -2.0225e+01, -1.9542e+01, -1.9555e+01,
#          -1.8285e+01, -1.8283e+01, -1.8575e+01, -1.9618e+01, -1.8853e+01,
#          -1.8601e+01, -2.0275e+01]])
# 13 tensor([[  0.0000, -20.2997, -19.6881, -21.6526, -23.3956, -22.1814, -22.3638,
#          -23.3835, -21.3127, -22.6383, -22.0047, -18.1678, -21.3358, -21.2100,
#          -23.1815, -22.1811, -23.6118, -25.5018, -23.0489, -18.9867, -22.2856,
#          -22.6108, -22.1218, -22.5690, -22.0472, -22.2206, -22.6280, -24.9848,
#          -24.3099, -22.5581, -22.9976, -23.4669, -21.8746, -23.5718, -21.9649,
#          -23.2813, -23.4975]])
# 14 tensor([[-5.3762e-05, -1.9971e+01, -1.9652e+01, -2.2557e+01, -2.2173e+01,
#          -2.0616e+01, -2.3059e+01, -2.2002e+01, -2.2366e+01, -2.2299e+01,
#          -2.3090e+01, -9.8314e+00, -1.7956e+01, -2.0291e+01, -2.1972e+01,
#          -2.2103e+01, -2.3249e+01, -2.4123e+01, -2.1502e+01, -1.8731e+01,
#          -2.0942e+01, -2.3064e+01, -2.1196e+01, -2.2194e+01, -2.1894e+01,
#          -2.1146e+01, -2.1103e+01, -2.4544e+01, -2.3076e+01, -2.1636e+01,
#          -2.3245e+01, -2.1680e+01, -2.3187e+01, -2.3042e+01, -2.2038e+01,
#          -2.5030e+01, -2.1220e+01]])
# 15 tensor([[-1.3221e+01, -2.0236e+01, -1.8405e+01, -2.0780e+01, -2.0443e+01,
#          -1.7315e+01, -2.2127e+01, -1.8754e+01, -2.1696e+01, -1.9604e+01,
#          -2.2249e+01, -5.7220e-06, -1.3161e+01, -1.6993e+01, -1.8889e+01,
#          -1.6189e+01, -1.6903e+01, -1.9628e+01, -1.5333e+01, -1.5255e+01,
#          -1.7159e+01, -1.5543e+01, -1.6340e+01, -1.7734e+01, -1.6011e+01,
#          -1.8238e+01, -1.6194e+01, -2.0355e+01, -1.6088e+01, -1.7677e+01,
#          -1.9061e+01, -1.8851e+01, -1.8742e+01, -1.5731e+01, -1.4865e+01,
#          -1.8673e+01, -1.6065e+01]])
# 16 tensor([[-1.1921e-06, -2.0104e+01, -1.9446e+01, -2.0990e+01, -2.2047e+01,
#          -2.2144e+01, -2.1475e+01, -2.2597e+01, -2.1613e+01, -2.1916e+01,
#          -2.2400e+01, -1.3629e+01, -1.8621e+01, -1.9101e+01, -2.1139e+01,
#          -2.0407e+01, -2.2025e+01, -2.3032e+01, -2.1436e+01, -1.8119e+01,
#          -2.1273e+01, -1.9888e+01, -2.0581e+01, -2.0296e+01, -2.0762e+01,
#          -2.0315e+01, -2.0602e+01, -2.3666e+01, -2.1640e+01, -2.0202e+01,
#          -2.1126e+01, -2.2867e+01, -2.1634e+01, -2.2200e+01, -1.8826e+01,
#          -2.2333e+01, -2.0571e+01]])
# 17 tensor([[-8.7973e-05, -2.0427e+01, -2.0330e+01, -2.3040e+01, -2.2429e+01,
#          -2.1507e+01, -2.3423e+01, -2.2854e+01, -2.3361e+01, -2.2957e+01,
#          -2.3806e+01, -9.3383e+00, -1.7691e+01, -1.9894e+01, -2.1811e+01,
#          -2.1751e+01, -2.3106e+01, -2.3949e+01, -2.1311e+01, -1.8362e+01,
#          -2.1336e+01, -2.2025e+01, -2.1301e+01, -2.1293e+01, -2.2027e+01,
#          -2.0535e+01, -2.0695e+01, -2.4231e+01, -2.2743e+01, -2.1235e+01,
#          -2.2565e+01, -2.2305e+01, -2.3489e+01, -2.3089e+01, -2.0782e+01,
#          -2.4800e+01, -2.0592e+01]])
# 18 tensor([[-1.3412e+01, -2.0012e+01, -1.8078e+01, -2.0371e+01, -2.0295e+01,
#          -1.7218e+01, -2.1802e+01, -1.8574e+01, -2.1630e+01, -1.9467e+01,
#          -2.2092e+01, -6.1989e-06, -1.3011e+01, -1.6751e+01, -1.8444e+01,
#          -1.5974e+01, -1.6709e+01, -1.9146e+01, -1.5227e+01, -1.5100e+01,
#          -1.7300e+01, -1.5368e+01, -1.6151e+01, -1.7144e+01, -1.5859e+01,
#          -1.7684e+01, -1.5639e+01, -1.9998e+01, -1.5663e+01, -1.7394e+01,
#          -1.8868e+01, -1.8829e+01, -1.8907e+01, -1.5645e+01, -1.4581e+01,
#          -1.8409e+01, -1.5667e+01]])
# 19 tensor([[-1.3113e-06, -1.9852e+01, -1.9324e+01, -2.0979e+01, -2.1871e+01,
#          -2.1807e+01, -2.1422e+01, -2.2462e+01, -2.1654e+01, -2.1759e+01,
#          -2.2210e+01, -1.3543e+01, -1.8598e+01, -1.9454e+01, -2.1210e+01,
#          -2.0577e+01, -2.2123e+01, -2.2941e+01, -2.1654e+01, -1.8376e+01,
#          -2.1498e+01, -2.0195e+01, -2.0735e+01, -2.0333e+01, -2.0838e+01,
#          -2.0228e+01, -2.0663e+01, -2.3599e+01, -2.1483e+01, -2.0300e+01,
#          -2.1339e+01, -2.2855e+01, -2.2093e+01, -2.2296e+01, -1.9046e+01,
#          -2.2579e+01, -2.0283e+01]])
# 20 tensor([[-1.3839e-04, -2.0253e+01, -2.0073e+01, -2.2730e+01, -2.2181e+01,
#          -2.0977e+01, -2.2904e+01, -2.2356e+01, -2.3242e+01, -2.2376e+01,
#          -2.3369e+01, -8.8858e+00, -1.7652e+01, -2.0299e+01, -2.2129e+01,
#          -2.1940e+01, -2.2989e+01, -2.3918e+01, -2.1364e+01, -1.8662e+01,
#          -2.1418e+01, -2.2284e+01, -2.1420e+01, -2.1395e+01, -2.1845e+01,
#          -2.0704e+01, -2.0738e+01, -2.4531e+01, -2.2535e+01, -2.1050e+01,
#          -2.2990e+01, -2.2471e+01, -2.3820e+01, -2.2955e+01, -2.0936e+01,
#          -2.4905e+01, -2.0137e+01]])
# 21 tensor([[-1.4022e+01, -2.0602e+01, -1.9042e+01, -2.1296e+01, -2.1257e+01,
#          -1.7907e+01, -2.2635e+01, -1.9250e+01, -2.2753e+01, -2.0066e+01,
#          -2.2703e+01, -2.6226e-06, -1.3723e+01, -1.8562e+01, -2.0099e+01,
#          -1.7182e+01, -1.7965e+01, -2.0666e+01, -1.6283e+01, -1.6743e+01,
#          -1.8940e+01, -1.6921e+01, -1.7779e+01, -1.8373e+01, -1.7178e+01,
#          -1.8925e+01, -1.7026e+01, -2.1988e+01, -1.7350e+01, -1.8898e+01,
#          -2.0790e+01, -2.0213e+01, -2.0507e+01, -1.6768e+01, -1.5892e+01,
#          -1.9687e+01, -1.6137e+01]])
# 22 tensor([[-4.7684e-06, -1.6173e+01, -1.6480e+01, -1.8246e+01, -1.8520e+01,
#          -1.8145e+01, -1.8076e+01, -1.8534e+01, -1.8113e+01, -1.8547e+01,
#          -1.8898e+01, -1.2323e+01, -1.7147e+01, -1.8557e+01, -1.9602e+01,
#          -2.0077e+01, -2.0565e+01, -2.0931e+01, -1.9861e+01, -1.8180e+01,
#          -2.0569e+01, -1.9694e+01, -1.9571e+01, -1.9535e+01, -1.9750e+01,
#          -1.8156e+01, -1.9110e+01, -2.1733e+01, -2.0165e+01, -1.8894e+01,
#          -1.9987e+01, -2.0971e+01, -2.1161e+01, -2.1358e+01, -1.9177e+01,
#          -2.1311e+01, -1.8354e+01]])
# 23 tensor([[-1.1921e-07, -1.7501e+01, -1.7295e+01, -2.0632e+01, -2.1436e+01,
#          -1.9849e+01, -2.0885e+01, -2.1145e+01, -1.9640e+01, -2.1396e+01,
#          -2.1729e+01, -1.7343e+01, -2.1056e+01, -2.2666e+01, -2.3297e+01,
#          -2.3813e+01, -2.4297e+01, -2.3816e+01, -2.2930e+01, -1.9819e+01,
#          -2.2364e+01, -2.4211e+01, -2.2042e+01, -2.3381e+01, -2.3838e+01,
#          -2.1950e+01, -2.3775e+01, -2.5049e+01, -2.4364e+01, -2.3251e+01,
#          -2.2950e+01, -2.2902e+01, -2.4763e+01, -2.4826e+01, -2.4058e+01,
#          -2.4248e+01, -2.1691e+01]])
# 24 tensor([[-1.1609e-02, -1.5287e+01, -4.4619e+00, -1.6730e+01, -1.6850e+01,
#          -1.6542e+01, -1.7087e+01, -1.7418e+01, -1.5791e+01, -1.7884e+01,
#          -1.7322e+01, -1.7798e+01, -2.0805e+01, -2.0834e+01, -2.2925e+01,
#          -2.3209e+01, -2.3879e+01, -2.1733e+01, -2.1888e+01, -1.7342e+01,
#          -2.0654e+01, -2.4019e+01, -2.1284e+01, -1.9169e+01, -2.3207e+01,
#          -2.0829e+01, -2.4045e+01, -2.3882e+01, -2.5753e+01, -2.1867e+01,
#          -2.0117e+01, -2.2147e+01, -2.4711e+01, -2.5726e+01, -2.2399e+01,
#          -2.2068e+01, -2.1075e+01]])
# 25 tensor([[-1.2562e+01, -1.3813e+01, -5.8412e-06, -1.5045e+01, -1.5490e+01,
#          -1.5491e+01, -1.7019e+01, -1.6841e+01, -1.4721e+01, -1.7816e+01,
#          -1.5967e+01, -1.8943e+01, -2.3301e+01, -2.2105e+01, -2.2564e+01,
#          -2.4786e+01, -2.3714e+01, -2.2532e+01, -2.1762e+01, -1.8263e+01,
#          -2.2655e+01, -2.4625e+01, -2.1354e+01, -1.8723e+01, -2.3198e+01,
#          -2.0472e+01, -2.3449e+01, -2.3569e+01, -2.4963e+01, -2.3617e+01,
#          -1.9893e+01, -2.3136e+01, -2.5347e+01, -2.5783e+01, -2.3896e+01,
#          -2.1692e+01, -2.1086e+01]])
# 26 tensor([[-3.4571e-06, -1.6302e+01, -1.3048e+01, -1.7088e+01, -1.6720e+01,
#          -1.8051e+01, -1.3773e+01, -1.8419e+01, -1.7616e+01, -1.9320e+01,
#          -1.6751e+01, -2.0431e+01, -2.1254e+01, -2.3006e+01, -2.4074e+01,
#          -2.2365e+01, -2.3628e+01, -2.4437e+01, -2.3542e+01, -2.0781e+01,
#          -2.2392e+01, -2.5710e+01, -2.4443e+01, -2.3951e+01, -2.4044e+01,
#          -2.2417e+01, -2.3659e+01, -2.6616e+01, -2.5317e+01, -2.1158e+01,
#          -2.3567e+01, -2.4913e+01, -2.6718e+01, -2.6381e+01, -2.4596e+01,
#          -2.5317e+01, -2.4048e+01]])
# 27 tensor([[-7.0019e+00, -1.3508e+01, -1.2704e+01, -1.1956e+01, -1.2570e+01,
#          -1.3562e+01, -9.3464e-04, -1.2716e+01, -1.4240e+01, -1.4071e+01,
#          -1.2504e+01, -2.1129e+01, -1.8962e+01, -2.0490e+01, -1.9882e+01,
#          -1.8539e+01, -1.8682e+01, -2.1758e+01, -2.1385e+01, -2.0197e+01,
#          -1.8615e+01, -2.2773e+01, -2.0324e+01, -1.9961e+01, -2.0663e+01,
#          -1.9843e+01, -2.0307e+01, -2.1382e+01, -2.1506e+01, -1.4893e+01,
#          -2.2235e+01, -2.0914e+01, -2.2526e+01, -2.1490e+01, -2.2809e+01,
#          -2.0799e+01, -2.0490e+01]])
# 28 tensor([[-4.5361e+00, -1.0201e+01, -1.0725e+01, -9.2570e+00, -1.0800e+01,
#          -1.1237e+01, -1.1038e-02, -1.0649e+01, -1.1211e+01, -1.1742e+01,
#          -1.0590e+01, -1.6851e+01, -1.5666e+01, -1.6166e+01, -1.6124e+01,
#          -1.4663e+01, -1.5195e+01, -1.8301e+01, -1.7671e+01, -1.6345e+01,
#          -1.5510e+01, -1.8147e+01, -1.6267e+01, -1.6031e+01, -1.7082e+01,
#          -1.5863e+01, -1.6255e+01, -1.7778e+01, -1.8170e+01, -1.3439e+01,
#          -1.8264e+01, -1.7356e+01, -1.8921e+01, -1.7230e+01, -1.8695e+01,
#          -1.6548e+01, -1.6608e+01]])
# 29 tensor([[-4.7684e-06, -1.4855e+01, -1.3932e+01, -1.4710e+01, -1.6542e+01,
#          -1.5317e+01, -1.3265e+01, -1.5374e+01, -1.5386e+01, -1.6336e+01,
#          -1.5304e+01, -1.6720e+01, -1.7416e+01, -1.8037e+01, -1.9177e+01,
#          -1.7606e+01, -1.9759e+01, -2.0885e+01, -1.9497e+01, -1.7875e+01,
#          -1.9264e+01, -1.9034e+01, -1.8887e+01, -1.7767e+01, -1.8185e+01,
#          -1.8086e+01, -1.8175e+01, -2.0788e+01, -2.0490e+01, -1.8398e+01,
#          -1.9624e+01, -2.0863e+01, -1.9590e+01, -1.9042e+01, -1.9896e+01,
#          -1.7966e+01, -1.9486e+01]])
# exec time:0.027866601943969727 label:010aaa15
# -----0--1--0---a--a--a---1-55-
#
# Process finished with exit code 0
